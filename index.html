<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì‹œ ì˜ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 0;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            width: 100%;
            max-width: 480px;
            overflow: hidden;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 1.5rem;
            text-align: center;
        }
        .header h2 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: 600;
        }
        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tabs {
            display: flex;
            background-color: #ecf0f1;
            border-bottom: 1px solid #ddd;
        }
        .tab-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: bold;
            color: #7f8c8d;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            background-color: white;
        }
        .tab-content {
            padding: 2rem;
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* í¼ ìŠ¤íƒ€ì¼ */
        .form-group {
            margin-bottom: 1.2rem;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #34495e;
            font-weight: 600;
            font-size: 0.95rem;
        }
        input, select {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #dfe6e9;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
            text-align: right;
            transition: border-color 0.2s;
        }
        select { text-align: left; }
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button.action-btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s;
            margin-top: 1rem;
        }
        .btn-save { background-color: #7f8c8d; color: white; }
        .btn-check { background-color: #3498db; color: white; }
        button:hover { opacity: 0.9; }

        /* ê²°ê³¼ì°½ ìŠ¤íƒ€ì¼ */
        #result {
            margin-top: 1.5rem;
            padding: 1.2rem;
            border-radius: 8px;
            display: none;
            text-align: center;
            line-height: 1.6;
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .result-danger { background-color: #fadbd8; color: #c0392b; border: 1px solid #f1948a; }
        .result-warning { background-color: #fef9e7; color: #b7950b; border: 1px solid #f7dc6f; }
        .result-safe { background-color: #d4efdf; color: #1e8449; border: 1px solid #a9dfbf; }

        .info-text {
            font-size: 0.85rem;
            color: #95a5a6;
            margin-top: 0.5rem;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>âœ… ê³µì‹œ ì˜ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('check')">ê³„ì•½ ê²€í† </button>
        <button class="tab-btn" onclick="openTab('setting')">ê¸°ì´ˆ ì •ë³´ ì„¤ì •</button>
    </div>

    <div id="check" class="tab-content active">
        <div class="form-group">
            <label>ğŸ“‚ ë¶„ì„ í•­ëª© ì„ íƒ</label>
            <select id="contractType">
                <option value="revenue">ë‹¨ì¼íŒë§¤ã†ê³µê¸‰ê³„ì•½ (ë§¤ì¶œì•¡ ê¸°ì¤€)</option>
                <option value="asset">ìœ í˜•ìì‚° ì·¨ë“ã†ì²˜ë¶„ (ìì‚°ì´ì•¡ ê¸°ì¤€)</option>
            </select>
        </div>

        <div class="form-group">
            <label>ğŸ’¸ ê¸ˆë²ˆ ê³„ì•½/ì·¨ë“ ê¸ˆì•¡ (ì›)</label>
            <input type="text" id="contractAmount" placeholder="ê¸ˆì•¡ ì…ë ¥ (VAT ì œì™¸)" onkeyup="inputNumberFormat(this)">
        </div>

        <button class="action-btn btn-check" onclick="checkDisclosure()">ê³µì‹œ ëŒ€ìƒ í™•ì¸í•˜ê¸°</button>

        <div id="result"></div>
    </div>

    <div id="setting" class="tab-content">
        <div class="form-group">
            <label>ğŸ“Š ìµœê·¼ ì‚¬ì—…ì—°ë„ ë§¤ì¶œì•¡ (ì›)</label>
            <input type="text" id="baseRevenue" placeholder="ë§¤ì¶œì•¡ ì…ë ¥" onkeyup="inputNumberFormat(this)">
        </div>
        <div class="form-group">
            <label>ğŸ’° ìµœê·¼ ì‚¬ì—…ì—°ë„ ìì‚°ì´ì•¡ (ì›)</label>
            <input type="text" id="baseAsset" placeholder="ìì‚°ì´ì•¡ ì…ë ¥" onkeyup="inputNumberFormat(this)">
        </div>
        <button class="action-btn btn-save" onclick="saveData()">ğŸ’¾ ì •ë³´ ì €ì¥í•˜ê¸°</button>
        <p class="info-text">* ì…ë ¥í•œ ì •ë³´ëŠ” ì´ PC(ë¸Œë¼ìš°ì €)ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.</p>
    </div>
</div>

<script>
    // íƒ­ ì „í™˜ ê¸°ëŠ¥
    function openTab(tabName) {
        // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¸°ê¸°
        const contents = document.getElementsByClassName('tab-content');
        for (let i = 0; i < contents.length; i++) {
            contents[i].classList.remove('active');
        }
        // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
        const btns = document.getElementsByClassName('tab-btn');
        for (let i = 0; i < btns.length; i++) {
            btns[i].classList.remove('active');
        }
        // ì„ íƒëœ íƒ­ í™œì„±í™”
        document.getElementById(tabName).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    window.onload = function() {
        const savedRevenue = localStorage.getItem('wisenut_revenue');
        const savedAsset = localStorage.getItem('wisenut_asset');
        
        if(savedRevenue) document.getElementById('baseRevenue').value = savedRevenue;
        if(savedAsset) document.getElementById('baseAsset').value = savedAsset;
    }

    // ë°ì´í„° ì €ì¥
    function saveData() {
        const revenue = document.getElementById('baseRevenue').value;
        const asset = document.getElementById('baseAsset').value;
        
        localStorage.setItem('wisenut_revenue', revenue);
        localStorage.setItem('wisenut_asset', asset);
        
        alert("âœ… ê¸°ì´ˆ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\n[ê³„ì•½ ê²€í† ] íƒ­ì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.");
        // ìë™ìœ¼ë¡œ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ ì´ë™
        document.getElementsByClassName('tab-btn')[0].click();
    }

    // ì½¤ë§ˆ ì°ê¸° ìœ í‹¸
    function inputNumberFormat(obj) {
        obj.value = comma(uncomma(obj.value));
    }
    function comma(str) {
        str = String(str);
        return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
    }
    function uncomma(str) {
        str = String(str);
        return str.replace(/[^\d]+/g, '');
    }

    // íŒë… ë¡œì§
    function checkDisclosure() {
        const type = document.getElementById('contractType').value;
        const contractAmountStr = uncomma(document.getElementById('contractAmount').value);
        
        if (!contractAmountStr) {
            alert("ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        const contractAmount = parseFloat(contractAmountStr);
        let baseAmount = 0;
        let baseName = "";

        if (type === 'revenue') {
            const revStr = uncomma(document.getElementById('baseRevenue').value);
            if(!revStr) { alert("ê¸°ì´ˆ ì •ë³´(ë§¤ì¶œì•¡)ê°€ ì—†ìŠµë‹ˆë‹¤.\n[ê¸°ì´ˆ ì •ë³´ ì„¤ì •] íƒ­ì—ì„œ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            baseAmount = parseFloat(revStr);
            baseName = "ë§¤ì¶œì•¡";
        } else {
            const assetStr = uncomma(document.getElementById('baseAsset').value);
            if(!assetStr) { alert("ê¸°ì´ˆ ì •ë³´(ìì‚°ì´ì•¡)ê°€ ì—†ìŠµë‹ˆë‹¤.\n[ê¸°ì´ˆ ì •ë³´ ì„¤ì •] íƒ­ì—ì„œ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            baseAmount = parseFloat(assetStr);
            baseName = "ìì‚°ì´ì•¡";
        }

        // ë¹„ìœ¨ ê³„ì‚°
        const ratio = (contractAmount / baseAmount) * 100;
        
        const resultDiv = document.getElementById('result');
        resultDiv.style.display = 'block';

        // íŒë… ê²°ê³¼ ì¶œë ¥
        if (ratio >= 10) {
            // 10% ì´ìƒ: ì˜ë¬´ ê³µì‹œ
            resultDiv.className = 'result-danger';
            resultDiv.innerHTML = `
                ğŸš¨ <strong>[ì˜ë¬´ ê³µì‹œ] ëŒ€ìƒì…ë‹ˆë‹¤.</strong><br><br>
                ë¹„ìœ¨: <strong>${ratio.toFixed(2)}%</strong> (ê¸°ì¤€: 10% ì´ìƒ)<br>
                <br>
                <span style="font-weight:bold; text-decoration:underline;">ê³µì‹œIRíŒ€ìœ¼ë¡œ ì‚¬ì „ í†µì§€ë°”ëë‹ˆë‹¤.</span>
            `;
        } else if (ratio > 9) {
            // 9% ì´ˆê³¼ ~ 10% ë¯¸ë§Œ: ììœ¨ ê³µì‹œ ê²€í†  (ì£¼ì˜)
            resultDiv.className = 'result-warning';
            resultDiv.innerHTML = `
                âš ï¸ <strong>[ììœ¨ ê³µì‹œ] ê²€í†  êµ¬ê°„ì…ë‹ˆë‹¤.</strong><br><br>
                ë¹„ìœ¨: <strong>${ratio.toFixed(2)}%</strong> (9% ì´ˆê³¼)<br>
                ì˜ë¬´ ê³µì‹œëŠ” ì•„ë‹ˆë‚˜, ììœ¨ê³µì‹œ ì‚¬í•­ì´ë¯€ë¡œ<br>
                <span style="font-weight:bold;">ê³µì‹œIRíŒ€ìœ¼ë¡œ ì‚¬ì „ í†µì§€ë°”ëë‹ˆë‹¤.</span>
            `;
        } else {
            // 9% ì´í•˜: í•´ë‹¹ ì—†ìŒ
            resultDiv.className = 'result-safe';
            resultDiv.innerHTML = `
                âœ… <strong>ê³µì‹œ ì˜ë¬´ ì—†ìŒ</strong><br><br>
                ë¹„ìœ¨: <strong>${ratio.toFixed(2)}%</strong><br>
                (ë¶€ì„œ ì „ê²° ì²˜ë¦¬ ê°€ëŠ¥)
            `;
        }
    }
</script>

</body>
</html>
